{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/dan/Documents/prueba_useit/mini_chat_grupal/frontend/mini_chat/src/ChatRoom.js\";\nimport React, { Component } from 'react';\nimport ReactDOM, { unmountComponentAtNode } from 'react-dom';\nimport styles from './ChatRoom.module.css';\nlet roomId = 'undefined';\nlet imgB64String = '';\nexport default class ChatRoom extends Component {\n  constructor(props) {\n    super(props);\n    this.rootRef = /*#__PURE__*/React.createRef();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: this.rootRef,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.profile,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 16,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 17,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"save pic\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 18,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 15,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.side_bar,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.profile_pic,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 22,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.change_photo,\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 24,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 23,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 21,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.profile_name,\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 28,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 29,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.room_name,\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 32,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.change_room,\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"change room\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 35,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: styles.logout,\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: styles.account,\n          children: \"Account\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.rooms,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Active Rooms\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"create new room\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.users,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Users\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.chat,\n        children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n          className: styles.messages\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.uploader,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 58,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.doodle_attribution,\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"https://www.vecteezy.com/free-vector/pattern\",\n            target: \"_blank\",\n            children: \"Pattern Vectors by Vecteezy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.edit_container,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              accept: \".png,.jpg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            name: \"\",\n            cols: \"30\",\n            rows: \"10\",\n            placeholder: \"Write a new message\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 4\n    }, this);\n  }\n\n  async componentDidMount() {\n    const comp = this;\n    const root = comp.rootRef.current;\n    console.log(this, comp);\n    const logout = root.querySelector(`.${styles.logout}`);\n    logout.addEventListener('click', function () {\n      window.location.replace('/login');\n    });\n    const addRoom = root.querySelector(`.${styles.rooms} button`);\n    addRoom.addEventListener('click', async function (evn) {\n      comp.createRoom();\n    });\n    const changeRoom = root.querySelector(`.${styles.change_room}`);\n    const deleteRoombtn = root.querySelector(`.${styles.delete_room}`);\n    changeRoom.addEventListener('click', async function () {\n      comp.renderRooms(await comp.getRooms());\n      root.querySelector(`.${styles.users}`).style.display = 'none';\n      root.querySelector(`.${styles.chat}`).style.display = 'none';\n      changeRoom.style.display = 'none';\n      deleteRoombtn.style.display = 'none';\n      nameRoombtn.style.display = 'none';\n    });\n    comp.setRoomsListeners();\n    const editor = root.querySelector(`.${styles.edit_container}`);\n    editor.querySelector('button').addEventListener('click', async function () {\n      const messageInput = editor.querySelector('textarea');\n      console.log(messageInput.value);\n      console.log('Send message');\n\n      if (messageInput.value !== '') {\n        await comp.sendMessage(messageInput.value);\n        messageInput.value = '';\n      }\n    });\n    editor.querySelector('div').addEventListener('click', function (evn) {\n      editor.querySelector('input').click();\n    });\n    editor.querySelector('input').addEventListener('change', function (evn) {\n      if (evn.target.files && evn.target.files.length > 0) {\n        const file = evn.target.files[0];\n        comp.renderImageUploader(file, root.querySelector(`.${styles.uploader} img`));\n      }\n\n      evn.target.value = '';\n      root.querySelector(`.${styles.uploader}`).style.display = 'block';\n    });\n    root.querySelector(`.${styles.uploader} h2`).addEventListener('click', function () {\n      root.querySelector(`.${styles.uploader}`).style.display = 'none';\n    });\n    root.querySelector(`.${styles.uploader} button`).addEventListener('click', async function (evn) {\n      console.log('uploade image');\n      await comp.uploadImage('message'); // console.log(roomId);\n\n      comp.loadMessages();\n      root.querySelector(`.${styles.uploader}`).style.display = 'none';\n    });\n    const profilePic = root.querySelector(`.${styles.profile_pic}`);\n    profilePic.addEventListener('mousemove', function () {\n      profilePic.querySelector(`.${styles.change_photo}`).style.display = 'block';\n    });\n    profilePic.addEventListener('mouseleave', function () {\n      profilePic.querySelector(`.${styles.change_photo}`).style.display = 'none';\n    });\n    profilePic.querySelector(`.${styles.change_photo}`).addEventListener('click', function () {\n      profilePic.querySelector(`.${styles.change_photo} input`).click();\n    });\n    profilePic.querySelector(`.${styles.change_photo} input`).addEventListener('change', function (evn) {\n      if (evn.target.files && evn.target.files.length > 0) {\n        const file = evn.target.files[0];\n        comp.renderImageUploader(file, root.querySelector(`.${styles.profile} img`));\n      }\n\n      evn.target.value = '';\n      root.querySelector(`.${styles.profile}`).style.display = 'block';\n    });\n    root.querySelector(`.${styles.profile} h2`).addEventListener('click', function () {\n      root.querySelector(`.${styles.profile}`).style.display = 'none';\n    });\n    root.querySelector(`.${styles.profile} button`).addEventListener('click', async function (evn) {\n      console.log('uploade image');\n      await comp.uploadImage('profile');\n      comp.fetchMedia('profile', {\n        object: profilePic.querySelector('img'),\n        id: 0\n      });\n\n      if (roomId !== 'undefined') {\n        await comp.getUsers(roomId);\n      }\n\n      root.querySelector(`.${styles.profile}`).style.display = 'none';\n    }); // comp.fetchMedia('profile', {\n    // \tobject: profilePic.querySelector('img'),\n    // \tid: 0\n    // });\n\n    const profileName = root.querySelector(`.${styles.profile_name}`);\n    profileName.querySelector('h1').addEventListener('click', function (evn) {\n      profileName.querySelector('input').style.display = 'block';\n      profileName.querySelector('input').value = evn.target.innerHTML;\n      profileName.querySelector('input').focus();\n    });\n    profileName.querySelector('input').addEventListener('keypress', async function (evn) {\n      if (evn.keyCode === 13) {\n        await comp.saveUsername(evn.target.value);\n        console.log('save username: ', evn.target.value);\n        evn.target.style.display = 'none';\n        profileName.querySelector('h1').innerHTML = evn.target.value;\n\n        if (roomId != 'undefined') {\n          await comp.getUsers(roomId);\n        }\n      }\n    });\n    profileName.querySelector('input').addEventListener('focusout', async function (evn) {\n      evn.target.style.display = 'none';\n      profileName.querySelector('h1').innerHTML = evn.target.value;\n      await comp.saveUsername(evn.target.value);\n    });\n    this.renderRooms(await this.getRooms());\n    this.setRoomsListeners();\n  }\n\n  async getRooms() {\n    const comp = this;\n    console.log('getRooms');\n    const req = await fetch(`http://localhost:8000/rooms`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Token ${localStorage.getItem('token')}`\n      }\n    });\n\n    if (req.status === 200) {\n      const res = await req.json();\n      console.log(res);\n      return res.rooms;\n    } else {\n      console.log(req);\n      return {};\n    }\n  }\n\n  setRoomsListeners() {\n    const root = this.rootRef.current;\n    const comp = this;\n    const rooms = root.querySelectorAll(`.${styles.rooms} li`);\n\n    for (const room of rooms) {\n      room.addEventListener('click', function (evn) {\n        comp.renderRoom(evn.target.getAttribute('room_id'), evn.target.innerHTML);\n      });\n    }\n  }\n\n  async renderRooms(rooms) {\n    const root = this.rootRef.current;\n    const comp = this;\n    console.log(rooms);\n    const roomsEl = root.querySelector(`.${styles.rooms}`);\n    const ul = roomsEl.querySelector('ul');\n    ul.innerHTML = '';\n\n    for (const room of rooms) {\n      const li = document.createElement('li');\n      li.setAttribute('room_id', room.id);\n      li.innerHTML = room.name;\n      ul.appendChild(li);\n    }\n  }\n\n  async renderRoom(id, name) {\n    const root = this.rootRef.current;\n    roomId = id;\n    const changeRoom = root.querySelector(`.${styles.change_room}`);\n    changeRoom.style.display = 'block';\n    const deleteRoom = root.querySelector(`.${styles.delete_room}`);\n    deleteRoom.style.display = 'block';\n    const nameRoom = root.querySelector(`.${styles.room_name}`);\n    nameRoom.style.display = 'block';\n    console.log('Render room');\n    console.log(name);\n    root.querySelector(`.${styles.room_name} h1`).innerHTML = name;\n    root.querySelector(`.${styles.rooms}`).style.display = 'none';\n    console.log(id);\n    await this.getUsers(id);\n    root.querySelector(`.${styles.chat}`).style.display = 'block';\n    await this.loadMessages();\n  }\n\n  async loadMessages() {\n    const req = await fetch(`http://localhost:8000/rooms/${roomId}/messages/all/`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Token ${localStorage.getItem('token')}`\n      }\n    });\n\n    if (req.status === 200) {\n      console.log(req.status);\n      const res = await req.json();\n      this.renderMessages(res.messages, res.id);\n      console.log(res);\n    } else {\n      this.renderMessages([], localStorage.getItem('user_id'));\n    }\n  }\n\n  async getUsers(id) {\n    console.log(id);\n    const req = await fetch(`http://localhost:8000/rooms/${id}/users`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Token ${localStorage.getItem('token')}`\n      }\n    });\n    const res = await req.json();\n    console.log(res);\n    this.rootRef.current.querySelector(`.${styles.users}`).style.display = 'block';\n    this.renderUsers(res.users);\n  }\n\n  renderUsers(users) {\n    const root = this.rootRef.current;\n    const cont = root.querySelector(`.${styles.users} ul`);\n    cont.innerHTML = '';\n\n    for (const user of users) {\n      const li = document.createElement('li');\n      const time = `${user.last_login.split('T')[1].split('.')[0]}`;\n      const date = `${user.last_login.split('T')[0]}`;\n      li.innerHTML = `<img><h1>${user.username}</h1><h2>Last login: ${time} / ${date}</h2>`;\n      cont.appendChild(li);\n      this.fetchMedia('profile', {\n        object: li.querySelector('img'),\n        id: user.id\n      });\n    }\n  }\n\n  async fetchMedia(type, obj) {\n    const req = await fetch(`http://localhost:8000/media/${obj.id}?type=${type}`, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Token ${localStorage.getItem('token')}`\n      }\n    });\n    const res = await req.blob();\n    obj.object.src = window.URL.createObjectURL(res); // console.log(res);\n  }\n\n  async renderMessages(messages, id) {\n    const comp = this;\n    const root = this.rootRef.current;\n    const ul = root.querySelector(`.${styles.messages}`);\n    ul.innerHTML = '';\n    const first = document.createElement('li');\n    first.innerHTML = '<h1>Welcome and Hi!!, start talking with your peers</h1>';\n    first.classList.add(styles.first);\n    ul.appendChild(first);\n\n    for (const message of messages) {\n      const mId = message.id;\n      const li = document.createElement('li');\n      let menu = '';\n      let mine = '';\n      let owner = message.user;\n\n      if (id === message.user_id) {\n        li.classList.add(styles.mine);\n        owner = 'me';\n        menu = `\n\t\t\t\t\t\t<div option=\"delete\"></div>\n\t\t\t\t\t\t<div menu=\"message\">\n\t\t\t\t\t\t\t<h1></h1>\n\t\t\t\t\t\t\t<h2 user_id=\"${id}\">Delete Message</h2>\n\t\t\t\t\t\t</div>`;\n        mine = 'mine';\n      }\n\n      let media = '';\n\n      if (message.media) {\n        media = `<img>`;\n      }\n\n      const date = new Date(message.created_at).toISOString().split('T')[1].slice(0, 5);\n      li.innerHTML = `<div cont=\"message\">\n\t\t\t\t\t\t${menu}\n\t\t\t\t\t\t<h3>${owner}</h3>\n\t\t\t\t\t\t${media}\n\t\t\t\t\t\t<p>${message.content}</p>\n\t\t\t\t\t\t<h4>${date}</h4>\n\t\t\t\t\t\t</div>`;\n\n      if (id === message.user_id) {\n        const optionBtn = li.querySelector('[option=\"delete\"]');\n        optionBtn.addEventListener('click', function (evn) {\n          li.querySelector('[menu=\"message\"]').style.display = 'block';\n        });\n        const closeBtn = li.querySelector('[menu=\"message\"] h1');\n        closeBtn.addEventListener('click', function (evn) {\n          li.querySelector('[menu=\"message\"]').style.display = 'none';\n        });\n        const deleteBtn = li.querySelector('[menu=\"message\"] h2');\n        deleteBtn.addEventListener('click', function (evn) {\n          const messageId = message.id;\n          const conf = window.confirm('Are you sure about deleting this message?');\n\n          if (conf) {\n            comp.removeMessage(messageId);\n          } else {\n            li.querySelector('[menu=\"message\"]').style.display = 'none';\n          } // li.querySelector('[menu=\"message\"]').style.display = 'none';\n\n        });\n      }\n\n      ul.appendChild(li);\n\n      if (message.media) {\n        const img = li.querySelector('img');\n        const obj = {\n          id: message.id,\n          object: img\n        };\n        await comp.fetchMedia('message', Object.assign({}, obj));\n      }\n    }\n\n    setTimeout(function () {\n      const lastIndex = ul.querySelectorAll('li').length - 1;\n      const lastLi = ul.querySelectorAll('li')[lastIndex];\n      ul.scrollTop = ul.scrollHeight;\n    }, 200);\n  }\n\n  async sendMessage(message) {\n    const req = await fetch(`http://localhost:8000/rooms/${roomId}/messages/`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Token ${localStorage.getItem('token')}`\n      },\n      body: JSON.stringify({\n        content: message\n      })\n    });\n\n    if (req.status === 200) {\n      this.loadMessages();\n    }\n  }\n\n  async renderImageUploader(file, img) {\n    const readHandler = async function (evn) {\n      let data = '';\n      let bytes = new Uint8Array(evn.target.result);\n      let length = bytes.byteLength;\n\n      for (let i = 0; i < length; i++) {\n        data += String.fromCharCode(bytes[i]);\n      }\n\n      data = window.btoa(data);\n      imgB64String = data;\n      img.src = `data:image/png;base64,${data}`;\n    };\n\n    let r = new FileReader();\n    let blob = file.slice(0, file.size);\n    r.onload = readHandler;\n    r.readAsArrayBuffer(blob);\n  }\n\n  async uploadImage(type) {\n    const req = await fetch(`http://localhost:8000/media/`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Token ${localStorage.getItem('token')}`\n      },\n      body: JSON.stringify({\n        data: imgB64String,\n        type: type,\n        roomId: roomId\n      })\n    });\n    const res = await req.json();\n    console.log(res);\n    return res;\n  }\n\n} // let roomId = 'undefined';\n// let imgB64String;\n// window.onload = function () {\n// async function saveUsername (username) {\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/users`,\n// \t\t{\n// \t\t\tmethod: 'PUT',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t},\n// \t\t\tbody: JSON.stringify({\n// \t\t\t\t'username': username\n// \t\t\t})\n// \t\t}\n// \t);\n// \t// console.log(await req.json());\n// \tif (req.status === 200) {\n// \t\tconst res = await req.json();\n// \t\tconsole.log(res);\n// \t}\n// }\n// async function createRoom () {\n// \tconsole.log(localStorage.getItem('token'));\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/rooms`,\n// \t\t{\n// \t\t\tmethod: 'POST',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t}\n// \t\t}\n// \t);\n// \t// console.log(await req.json());\n// \tif (req.status === 200) {\n// \t\tconst res = await req.json();\n// \t\trenderRoom(res.id, res.name);\n// \t}\n// }\n// async function saveRoomName (name) {\n// \tconsole.log(name);\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/rooms`,\n// \t\t{\n// \t\t\tmethod: 'PUT',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t},\n// \t\t\tbody: JSON.stringify({\n// \t\t\t\tname: name,\n// \t\t\t\tid: roomId\n// \t\t\t})\n// \t\t}\n// \t);\n// }\n// \tsetTimeout(function () {\n// \t\troomsEl.style.display = 'block';\n// \t\tsetRoomsListeners();\n// \t}, 100);\n// }\n// async function deleteRoom () {\n// \tconsole.log('delete rooms');\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/rooms/${roomId}/`,\n// \t\t{\n// \t\t\tmethod: 'DELETE',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t}\n// \t\t}\n// \t);\n// \tif (req.status === 200) {\n// \t\tconst res = await req.json();\n// \t\tconsole.log(res);\n// \t} else {\n// \t}\n// }\n// function setRoomsListeners () {\n// \tconst rooms = document.querySelectorAll('#rooms li');\n// \tfor (const room of rooms) {\n// \t\troom.addEventListener('click', function (evn) {\n// \t\t\trenderRoom(evn.target.getAttribute('room_id'), evn.target.innerHTML);\n// \t\t});\n// \t}\n// }\n// async function removeMessage (messageId) {\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/messages/${messageId}/`,\n// \t\t{\n// \t\t\tmethod: 'DELETE',\n// \t\t\theaders: {\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t}\n// \t\t}\n// \t);\n// \tconst res = await req.json();\n// \tconsole.log(res);\n// \tloadMessages();\n// }","map":{"version":3,"sources":["/home/dan/Documents/prueba_useit/mini_chat_grupal/frontend/mini_chat/src/ChatRoom.js"],"names":["React","Component","ReactDOM","unmountComponentAtNode","styles","roomId","imgB64String","ChatRoom","constructor","props","rootRef","createRef","render","profile","side_bar","profile_pic","change_photo","profile_name","room_name","change_room","logout","account","rooms","users","chat","messages","uploader","doodle_attribution","edit_container","componentDidMount","comp","root","current","console","log","querySelector","addEventListener","window","location","replace","addRoom","evn","createRoom","changeRoom","deleteRoombtn","delete_room","renderRooms","getRooms","style","display","nameRoombtn","setRoomsListeners","editor","messageInput","value","sendMessage","click","target","files","length","file","renderImageUploader","uploadImage","loadMessages","profilePic","fetchMedia","object","id","getUsers","profileName","innerHTML","focus","keyCode","saveUsername","req","fetch","method","headers","localStorage","getItem","status","res","json","querySelectorAll","room","renderRoom","getAttribute","roomsEl","ul","li","document","createElement","setAttribute","name","appendChild","deleteRoom","nameRoom","renderMessages","renderUsers","cont","user","time","last_login","split","date","username","type","obj","blob","src","URL","createObjectURL","first","classList","add","message","mId","menu","mine","owner","user_id","media","Date","created_at","toISOString","slice","content","optionBtn","closeBtn","deleteBtn","messageId","conf","confirm","removeMessage","img","Object","assign","setTimeout","lastIndex","lastLi","scrollTop","scrollHeight","body","JSON","stringify","readHandler","data","bytes","Uint8Array","result","byteLength","i","String","fromCharCode","btoa","r","FileReader","size","onload","readAsArrayBuffer"],"mappings":"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CrB,8BADqB,EAEtB;AACCC,MAAAA,MAAM,EAAE,MADT;AAECC,MAAAA,OAAO,EAAE;AACR,wBAAgB,kBADR;AAER,yBAAkB,SAAQC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B;AAFhD,OAFV;AAMC+D,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACpBE,QAAAA,IAAI,EAAE5I,YADc;AAEpBoG,QAAAA,IAAI,EAAEA,IAFc;AAGpBrG,QAAAA,MAAM,EAAEA;AAHY,OAAf;AANP,KAFsB,CAAvB;AAeA,UAAM4E,GAAG,GAAG,MAAMP,GAAG,CAACQ,IAAJ,EAAlB;AACAjD,IAAAA,OAAO,CAACC,GAAR,CAAY+C,GAAZ;AACA,WAAOA,GAAP;AACA;;AA3b8C,C,CAwchD;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM, { unmountComponentAtNode } from 'react-dom';\nimport styles from './ChatRoom.module.css';\nlet roomId = 'undefined';\nlet imgB64String = '';\n\nexport default class ChatRoom extends Component {\n\tconstructor (props) {\n\t\tsuper(props);\n\t\tthis.rootRef = React.createRef();\n\t}\n\trender () {\n\t\treturn(\n\t\t\t<div ref={this.rootRef}>\n\t\t\t\t<div className={ styles.profile }>\n\t\t\t\t\t<h2></h2>\n\t\t\t\t\t<img></img>\n\t\t\t\t\t<button>save pic</button>\n\t\t\t\t</div>\n\t\t\t\t<div className={ styles.side_bar }>\n\t\t\t\t\t<div className={ styles.profile_pic }>\n\t\t\t\t\t\t<img></img>\n\t\t\t\t\t\t<div className={ styles.change_photo }>\n\t\t\t\t\t\t\t<input type=\"file\"></input>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={ styles.profile_name }>\n\t\t\t\t\t\t<h1>username</h1>\n\t\t\t\t\t\t<input type=\"text\"></input>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={ styles.room_name }>\n\t\t\t\t\t\t<h1></h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={ styles.change_room }>\n\t\t\t\t\t\t<h1>change room</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<h2 className={ styles.logout }>Logout</h2>\n\t\t\t\t\t<h2 className={ styles.account }>Account</h2>\n\t\t\t\t</div>\n\t\t\t\t<div className={ styles.rooms }>\n\t\t\t\t\t<h1>Active Rooms</h1>\n\t\t\t\t\t<ul>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<button>create new room</button>\n\t\t\t\t</div>\n\t\t\t\t<div className={ styles.users }>\n\t\t\t\t\t<h1>Users</h1>\n\t\t\t\t\t<ul>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\n\t\t\t\t<div className={ styles.chat }>\n\t\t\t\t\t<ul className={ styles.messages }>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div className={ styles.uploader }>\n\t\t\t\t\t\t<h2></h2>\n\t\t\t\t\t\t<img></img>\n\t\t\t\t\t\t<button></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={ styles.doodle_attribution }>\n\t\t\t\t\t\t<a href=\"https://www.vecteezy.com/free-vector/pattern\" target=\"_blank\">Pattern Vectors by Vecteezy</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={ styles.edit_container }>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<input type=\"file\" accept=\".png,.jpg\"></input>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<textarea name=\"\" cols=\"30\" rows=\"10\" placeholder=\"Write a new message\"></textarea>\n\t\t\t\t\t\t<button></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\tasync componentDidMount () {\n\t\tconst comp = this;\n\t\tconst root = comp.rootRef.current;\n\t\tconsole.log(this, comp);\n\t\tconst logout = root.querySelector(`.${styles.logout}`);\n\t\tlogout.addEventListener('click', function () {\n\t\t\twindow.location.replace('/login');\n\t\t});\n\t\tconst addRoom = root.querySelector(`.${styles.rooms} button`);\n\t\taddRoom.addEventListener('click', async function (evn) {\n\t\t\tcomp.createRoom();\n\t\t});\n\t\tconst changeRoom = root.querySelector(`.${styles.change_room}`);\n\t\tconst deleteRoombtn = root.querySelector(`.${styles.delete_room}`);\n\t\tchangeRoom.addEventListener('click', async function () {\n\t\t\tcomp.renderRooms(await comp.getRooms());\n\t\t\troot.querySelector(`.${styles.users}`).style.display = 'none';\n\t\t\troot.querySelector(`.${styles.chat}`).style.display = 'none';\n\t\t\tchangeRoom.style.display = 'none';\n\t\t\tdeleteRoombtn.style.display = 'none';\n\t\t\tnameRoombtn.style.display = 'none';\n\t\t});\n\t\tcomp.setRoomsListeners();\n\t\tconst editor = root.querySelector(`.${styles.edit_container}`);\n\t\teditor.querySelector('button').addEventListener('click', async function () {\n\t\t\tconst messageInput = editor.querySelector('textarea');\n\t\t\tconsole.log(messageInput.value);\n\t\t\tconsole.log('Send message');\n\t\t\tif (messageInput.value !== '') {\n\t\t\t\tawait comp.sendMessage(messageInput.value);\n\t\t\t\tmessageInput.value = '';\n\t\t\t}\n\t\t});\n\t\teditor.querySelector('div').addEventListener('click', function (evn) {\n\t\t\teditor.querySelector('input').click();\n\t\t});\n\t\teditor.querySelector('input').addEventListener('change', function (evn) {\n\t\t\tif (evn.target.files && evn.target.files.length > 0) {\n\t\t\t\tconst file = evn.target.files[0];\n\t\t\t\tcomp.renderImageUploader(file, root.querySelector(`.${styles.uploader} img`));\n\t\t\t}\n\t\t\tevn.target.value = '';\n\t\t\troot.querySelector(`.${styles.uploader}`).style.display = 'block';\n\t\t});\n\t\troot.querySelector(`.${styles.uploader} h2`).addEventListener('click', function () {\n\t\t\troot.querySelector(`.${styles.uploader }`).style.display = 'none';\n\t\t});\n\t\troot.querySelector(`.${styles.uploader} button`).addEventListener('click', async function (evn) {\n\t\t\tconsole.log('uploade image');\n\t\t\tawait comp.uploadImage('message');\n\t\t\t// console.log(roomId);\n\t\t\tcomp.loadMessages();\n\t\t\troot.querySelector(`.${styles.uploader}`).style.display = 'none';\n\t\t});\n\t\tconst profilePic = root.querySelector(`.${styles.profile_pic}`);\n\t\tprofilePic.addEventListener('mousemove', function () {\n\t\t\tprofilePic.querySelector(`.${styles.change_photo}`).style.display = 'block';\n\t\t});\n\t\tprofilePic.addEventListener('mouseleave', function () {\n\t\t\tprofilePic.querySelector(`.${styles.change_photo}`).style.display = 'none';\n\t\t});\n\t\tprofilePic.querySelector(`.${styles.change_photo}`).addEventListener('click', function () {\n\t\t\tprofilePic.querySelector(`.${styles.change_photo} input`).click();\n\t\t});\n\t\tprofilePic.querySelector(`.${styles.change_photo} input`).addEventListener('change', function (evn) {\n\t\t\tif (evn.target.files && evn.target.files.length > 0) {\n\t\t\t\tconst file = evn.target.files[0];\n\t\t\t\tcomp.renderImageUploader(file, root.querySelector(`.${styles.profile} img`));\n\t\t\t}\n\t\t\tevn.target.value = '';\n\t\t\troot.querySelector(`.${styles.profile}`).style.display = 'block';\n\t\t});\n\t\troot.querySelector(`.${styles.profile} h2`).addEventListener('click', function () {\n\t\t\troot.querySelector(`.${styles.profile}`).style.display = 'none';\n\t\t});\n\t\troot.querySelector(`.${styles.profile} button`).addEventListener('click', async function (evn) {\n\t\t\tconsole.log('uploade image');\n\t\t\tawait comp.uploadImage('profile');\n\t\t\tcomp.fetchMedia('profile', {\n\t\t\t\tobject: profilePic.querySelector('img'),\n\t\t\t\tid: 0\n\t\t\t})\n\t\t\tif (roomId !== 'undefined') {\n\t\t\t\tawait comp.getUsers(roomId);\n\t\t\t}\n\t\t\troot.querySelector(`.${styles.profile}`).style.display = 'none';\n\t\t});\n\t\t// comp.fetchMedia('profile', {\n\t\t// \tobject: profilePic.querySelector('img'),\n\t\t// \tid: 0\n\t\t// });\n\t\tconst profileName = root.querySelector(`.${styles.profile_name}`);\n\t\tprofileName.querySelector('h1').addEventListener('click', function (evn) {\n\t\t\tprofileName.querySelector('input').style.display = 'block';\n\t\t\tprofileName.querySelector('input').value = evn.target.innerHTML;\n\t\t\tprofileName.querySelector('input').focus();\n\t\t});\n\t\tprofileName.querySelector('input').addEventListener('keypress', async function (evn) {\n\t\t\tif (evn.keyCode === 13) {\n\t\t\t\tawait comp.saveUsername(evn.target.value)\n\t\t\t\tconsole.log('save username: ', evn.target.value);\n\t\t\t\tevn.target.style.display = 'none';\n\t\t\t\tprofileName.querySelector('h1').innerHTML = evn.target.value;\n\t\t\t\tif (roomId != 'undefined') {\n\t\t\t\t\tawait comp.getUsers(roomId);\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t\tprofileName.querySelector('input').addEventListener('focusout', async function (evn) {\n\t\t\tevn.target.style.display = 'none';\n\t\t\tprofileName.querySelector('h1').innerHTML = evn.target.value;\n\t\t\tawait comp.saveUsername(evn.target.value)\n\t\t});\n\t\tthis.renderRooms(await this.getRooms());\n\t\tthis.setRoomsListeners();\n\t}\n\tasync getRooms () {\n\t\tconst comp = this;\n\t\tconsole.log('getRooms');\n\t\tconst req = await fetch(\n\t\t\t`http://localhost:8000/rooms`,\n\t\t\t{\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tif (req.status === 200) {\n\t\t\tconst res = await req.json();\n\t\t\tconsole.log(res);\n\t\t\treturn res.rooms;\n\t\t} else {\n\t\t\tconsole.log(req);\n\t\t\treturn {};\n\t\t}\n\t}\n\tsetRoomsListeners () {\n\t\tconst root = this.rootRef.current;\n\t\tconst comp = this;\n\t\tconst rooms = root.querySelectorAll(`.${styles.rooms} li`);\n\t\tfor (const room of rooms) {\n\t\t\troom.addEventListener('click', function (evn) {\n\t\t\t\tcomp.renderRoom(evn.target.getAttribute('room_id'), evn.target.innerHTML);\n\t\t\t});\n\t\t}\n\t}\n\tasync renderRooms (rooms) {\n\t\tconst root = this.rootRef.current;\n\t\tconst comp = this;\n\t\tconsole.log(rooms);\n\t\tconst roomsEl = root.querySelector(`.${styles.rooms}`);\n\t\tconst ul = roomsEl.querySelector('ul');\n\t\tul.innerHTML = '';\n\t\tfor (const room of rooms) {\n\t\t\tconst li = document.createElement('li');\n\t\t\tli.setAttribute('room_id', room.id);\n\t\t\tli.innerHTML = room.name;\n\t\t\tul.appendChild(li);\n\t\t}\n\t}\n\tasync renderRoom (id, name) {\n\t\tconst root = this.rootRef.current;\n\t\troomId = id;\n\t\tconst changeRoom = root.querySelector(`.${styles.change_room}`);\n\t\tchangeRoom.style.display = 'block';\n\t\tconst deleteRoom = root.querySelector(`.${styles.delete_room}`);\n\t\tdeleteRoom.style.display = 'block';\n\t\tconst nameRoom = root.querySelector(`.${styles.room_name}`);\n\t\tnameRoom.style.display = 'block';\n\t\tconsole.log('Render room');\n\t\tconsole.log(name)\n\t\troot.querySelector(`.${styles.room_name} h1`).innerHTML = name;\n\t\troot.querySelector(`.${styles.rooms}`).style.display = 'none';\n\t\tconsole.log(id);\n\t\tawait this.getUsers(id);\n\t\troot.querySelector(`.${styles.chat}`).style.display = 'block';\n\t\tawait this.loadMessages();\n\t}\n\tasync loadMessages () {\n\t\tconst req = await fetch(\n\t\t\t`http://localhost:8000/rooms/${roomId}/messages/all/`,\n\t\t\t{\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tif (req.status === 200) {\n\t\t\tconsole.log(req.status);\n\t\t\tconst res = await req.json();\n\t\t\tthis.renderMessages(res.messages, res.id);\n\t\t\tconsole.log(res);\n\t\t} else {\n\t\t\tthis.renderMessages([], localStorage.getItem('user_id'));\n\t\t}\n\t\t\n\t}\n\n\tasync getUsers (id) {\n\t\tconsole.log(id);\n\t\tconst req = await fetch(\n\t\t\t`http://localhost:8000/rooms/${id}/users`,\n\t\t\t{\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tconst res = await req.json();\n\t\tconsole.log(res);\n\t\tthis.rootRef.current.querySelector(`.${styles.users}`).style.display = 'block';\n\t\tthis.renderUsers(res.users);\n\t}\n\trenderUsers (users) {\n\t\tconst root = this.rootRef.current;\n\t\tconst cont = root.querySelector(`.${styles.users} ul`);\n\t\tcont.innerHTML = '';\n\t\tfor (const user of users) {\n\t\t\tconst li = document.createElement('li');\n\t\t\tconst time = `${user.last_login.split('T')[1].split('.')[0]}`;\n\t\t\tconst date = `${user.last_login.split('T')[0]}`;\n\t\t\tli.innerHTML = `<img><h1>${user.username}</h1><h2>Last login: ${time} / ${date}</h2>`;\n\t\t\tcont.appendChild(li);\n\t\t\tthis.fetchMedia('profile', {\n\t\t\t\tobject: li.querySelector('img'),\n\t\t\t\tid: user.id\n\t\t\t})\n\t\t}\n\t}\n\tasync fetchMedia (type, obj) {\n\t\tconst req = await fetch(\n\t\t\t`http://localhost:8000/media/${obj.id}?type=${type}`,\n\t\t\t{\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tconst res = await req.blob();\n\t\tobj.object.src = window.URL.createObjectURL(res);\n\t\t// console.log(res);\n\t}\n\tasync renderMessages (messages, id) {\n\t\tconst comp = this;\n\t\tconst root = this.rootRef.current;\n\t\tconst ul = root.querySelector(`.${styles.messages}`);\n\t\tul.innerHTML = '';\n\t\tconst first = document.createElement('li');\n\t\tfirst.innerHTML = '<h1>Welcome and Hi!!, start talking with your peers</h1>';\n\t\tfirst.classList.add(styles.first);\n\t\tul.appendChild(first);\n\t\tfor (const message of messages) {\n\t\t\tconst mId = message.id;\n\t\t\tconst li = document.createElement('li');\n\t\t\tlet menu = '';\n\t\t\tlet mine = '';\n\t\t\tlet owner = message.user\n\t\t\tif (id === message.user_id) {\n\t\t\t\tli.classList.add(styles.mine);\n\t\t\t\towner = 'me'\n\t\t\t\tmenu = `\n\t\t\t\t\t\t<div option=\"delete\"></div>\n\t\t\t\t\t\t<div menu=\"message\">\n\t\t\t\t\t\t\t<h1></h1>\n\t\t\t\t\t\t\t<h2 user_id=\"${id}\">Delete Message</h2>\n\t\t\t\t\t\t</div>`;\n\t\t\t\tmine = 'mine';\n\t\t\t}\n\t\t\tlet media = '';\n\t\t\tif (message.media) {\n\t\t\t\tmedia = `<img>`\n\t\t\t}\n\t\t\tconst date = new Date(message.created_at).toISOString().split('T')[1].slice(0, 5);\n\t\t\tli.innerHTML = `<div cont=\"message\">\n\t\t\t\t\t\t${menu}\n\t\t\t\t\t\t<h3>${owner}</h3>\n\t\t\t\t\t\t${media}\n\t\t\t\t\t\t<p>${message.content}</p>\n\t\t\t\t\t\t<h4>${date}</h4>\n\t\t\t\t\t\t</div>`;\n\t\t\tif (id === message.user_id) {\n\t\t\t\tconst optionBtn = li.querySelector('[option=\"delete\"]');\n\t\t\t\toptionBtn.addEventListener('click', function (evn) {\n\t\t\t\t\tli.querySelector('[menu=\"message\"]').style.display = 'block';\n\t\t\t\t});\n\t\t\t\tconst closeBtn = li.querySelector('[menu=\"message\"] h1');\n\t\t\t\tcloseBtn.addEventListener('click', function (evn) {\n\t\t\t\t\tli.querySelector('[menu=\"message\"]').style.display = 'none';\n\t\t\t\t});\n\t\t\t\tconst deleteBtn = li.querySelector('[menu=\"message\"] h2');\n\t\t\t\tdeleteBtn.addEventListener('click', function (evn) {\n\t\t\t\t\tconst messageId = message.id;\n\t\t\t\t\tconst conf = window.confirm('Are you sure about deleting this message?');\n\t\t\t\t\tif (conf) {\n\t\t\t\t\t\tcomp.removeMessage(messageId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tli.querySelector('[menu=\"message\"]').style.display = 'none';\n\t\t\t\t\t}\n\t\t\t\t\t// li.querySelector('[menu=\"message\"]').style.display = 'none';\n\t\t\t\t});\n\t\t\t}\n\t\t\tul.appendChild(li);\n\t\t\tif (message.media) {\n\t\t\t\tconst img = li.querySelector('img');\n\t\t\t\tconst obj = {id: message.id, object: img};\n\t\t\t\tawait comp.fetchMedia('message', Object.assign({}, obj));\n\t\t\t}\n\t\t}\n\t\tsetTimeout(function () {\n\t\t\tconst lastIndex = ul.querySelectorAll('li').length - 1;\n\t\t\tconst lastLi = ul.querySelectorAll('li')[lastIndex];\n\t\t\tul.scrollTop = ul.scrollHeight;\n\t\t}, 200);\n\t}\n\tasync sendMessage (message) {\n\t\tconst req = await fetch(\n\t\t\t`http://localhost:8000/rooms/${roomId}/messages/`,\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tcontent: message\n\t\t\t\t})\n\t\t\t}\n\t\t);\n\t\tif (req.status === 200) {\n\t\t\tthis.loadMessages();\n\t\t}\n\t}\n\tasync  renderImageUploader (file, img) {\n\t\tconst readHandler = async function (evn) {\n\t\t\tlet data = '';\n\t\t\tlet bytes = new Uint8Array(evn.target.result);\n\t\t\tlet length = bytes.byteLength;\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tdata += String.fromCharCode(bytes[i])\n\t\t\t}\n\t\t\tdata = window.btoa(data);\n\t\t\timgB64String = data;\n\t\t\timg.src = `data:image/png;base64,${data}`;\n\t\t}\n\t\tlet r = new FileReader();\n\t\tlet blob = file.slice(0, file.size);\n\t\tr.onload = readHandler;\n\t\tr.readAsArrayBuffer(blob);\n\t}\n\tasync uploadImage (type) {\n\t\tconst req = await fetch(\n\t\t\t`http://localhost:8000/media/`,\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tdata: imgB64String,\n\t\t\t\t\ttype: type,\n\t\t\t\t\troomId: roomId\n\t\t\t\t})\n\t\t\t}\n\t\t);\n\t\tconst res = await req.json();\n\t\tconsole.log(res);\n\t\treturn res;\n\t}\n}\n\n\n\n\n\n\n\n\n\n\n\n// let roomId = 'undefined';\n// let imgB64String;\n// window.onload = function () {\n\t\n// async function saveUsername (username) {\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/users`,\n// \t\t{\n// \t\t\tmethod: 'PUT',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t},\n// \t\t\tbody: JSON.stringify({\n// \t\t\t\t'username': username\n// \t\t\t})\n// \t\t}\n// \t);\n// \t// console.log(await req.json());\n// \tif (req.status === 200) {\n// \t\tconst res = await req.json();\n// \t\tconsole.log(res);\n// \t}\n// }\n// async function createRoom () {\n// \tconsole.log(localStorage.getItem('token'));\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/rooms`,\n// \t\t{\n// \t\t\tmethod: 'POST',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t}\n// \t\t}\n// \t);\n// \t// console.log(await req.json());\n// \tif (req.status === 200) {\n// \t\tconst res = await req.json();\n// \t\trenderRoom(res.id, res.name);\n// \t}\n// }\n// async function saveRoomName (name) {\n// \tconsole.log(name);\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/rooms`,\n// \t\t{\n// \t\t\tmethod: 'PUT',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t},\n// \t\t\tbody: JSON.stringify({\n// \t\t\t\tname: name,\n// \t\t\t\tid: roomId\n// \t\t\t})\n// \t\t}\n// \t);\n// }\n\n// \tsetTimeout(function () {\n// \t\troomsEl.style.display = 'block';\n// \t\tsetRoomsListeners();\n// \t}, 100);\n\t\n// }\n// async function deleteRoom () {\n// \tconsole.log('delete rooms');\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/rooms/${roomId}/`,\n// \t\t{\n// \t\t\tmethod: 'DELETE',\n// \t\t\theaders: {\n// \t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t}\n// \t\t}\n// \t);\n// \tif (req.status === 200) {\n// \t\tconst res = await req.json();\n// \t\tconsole.log(res);\n// \t} else {\n\t\t\n// \t}\n// }\n// function setRoomsListeners () {\n// \tconst rooms = document.querySelectorAll('#rooms li');\n// \tfor (const room of rooms) {\n// \t\troom.addEventListener('click', function (evn) {\n// \t\t\trenderRoom(evn.target.getAttribute('room_id'), evn.target.innerHTML);\n// \t\t});\n// \t}\n// }\n\n\n\n\n\n\n\n\n// async function removeMessage (messageId) {\n// \tconst req = await fetch(\n// \t\t`http://localhost:8000/messages/${messageId}/`,\n// \t\t{\n// \t\t\tmethod: 'DELETE',\n// \t\t\theaders: {\n// \t\t\t\t'Authorization': `Token ${localStorage.getItem('token')}`\n// \t\t\t}\n// \t\t}\n// \t);\n// \tconst res = await req.json();\n// \tconsole.log(res);\n// \tloadMessages();\n// }\n"]},"metadata":{},"sourceType":"module"}